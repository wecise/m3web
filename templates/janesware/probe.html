<!--

    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[    CODE BY WANGZD    ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]

-->
{{template "base/head" .}}
<!-- zTree Core CSS -->
<link href="{{AppSubUrl}}/web/vendor/zTree/css/systemStyle/zTreeStyle.css" type="text/css" rel="stylesheet">

<style type="text/css">

    /* For content */
    #content.content{
        padding: 0px 5px;
    }

    .page-header {
        margin: 0px 0px 5px 0px;
        font-size: 18px;
        color: #888888;
    }

    /* For Nav tabs style */
    .nav-tabs {
        background-color: rgb(255, 255, 255) !important;
        background-image: none!important;
        background-repeat: repeat-x;
        border-radius: 0px!important;
    }
    ul.nav-main > li.active {
        border-bottom: 2px solid rgb(3, 169, 244)!important;
    }

</style>

<div id="app"></div>

<!--zTree Core JS-->
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.core-3.5.js"></script>
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.excheck-3.5.js"></script>
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.exedit-3.5.js"></script>

<link rel="vc" href="{{AppSubUrl}}/web/component/vue-editor-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-entity-tree-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-search-preset-component_{{.Lang}}.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-search-input-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-base-tree-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-script-manager-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-bootstrap-table.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-base-table-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-dispatch-manager-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-kpi-manager-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-kpi-tree-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-object-detail-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/ai/ai-robot-component.html"></link>

<link rel="vc" href="{{AppSubUrl}}/web/component/probe/probe-tree-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/probe/probe-card-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/probe/probe-list-datatables-component.html"></link>

<link rel="vc" href="{{AppSubUrl}}/web/component/policy/policy-list-datatables-component.html"></link>

<link rel="vc" href="{{AppSubUrl}}/web/component/log/log-list-datatables-component.html"></link>

<link rel="vc" href="{{AppSubUrl}}/web/component/script/script-list-datatables-component.html"></link>

<SCRIPT type="text/javascript">

    'use static';

    VueLoader.onloaded(["vue-base-tree-component",
                        "vue-search-preset-component",
                        "vue-search-input-component",
                        "vue-script-manager-component",
                        "vue-bootstrap-table",
                        "vue-base-table-component",
                        "vue-dispatch-manager-component",
                        "vue-kpi-manager-component",
                        "vue-kpi-tree-component",
                        "vue-object-detail-component",
                        "ai-robot-component",
                        "probe-tree-component",
                        "probe-card-component",
                        "probe-list-datatables-component",
                        "policy-list-datatables-component",
                        "log-list-datatables-component",
                        "script-list-datatables-component"],function() {


        moment.locale(`{{.Lang}}`);

        $(function () {

            var appVue = new Vue({
                delimiters: ['${', '}'],
                el: "#app",
                template: "#app-template",
                data: {
                    probe: {},
                    policy: {},
                    log: {},
                    script: {}
                },
                mounted: function () {
                    let self = this;

                    self.$nextTick(function () {
                        
                        self.init();

                        /* enable tooltip for all A tag */
                        $("a").tooltip({
                            enable: true,
                            position: { my: "left+15 center", at: "right center" }
                        });
                    })
                },
                methods: {
                    init: function () {
                        let self = this;

                        let rtnProbe = callFsJScript('probe_summary_by_probe.js','');

                        if(rtnProbe.status == 'ok'){
                            self.probe = rtnProbe.message;
                        }


                        let rtnPolicy = callFsJScript('probe_summary_by_policy.js','');

                        if(rtnPolicy.status == 'ok'){
                            self.policy = rtnPolicy.message;
                        }

                        let rtnLog = callFsJScript('probe_summary_by_log.js','');

                        if(rtnLog.status == 'ok'){
                            self.log = rtnLog.message;
                        }

                        let rtnScript = callFsJScript('probe_summary_by_script.js','');

                        if(rtnScript.status == 'ok'){
                            self.script = rtnScript.message;
                        }

                    }
                }
            })

        });


    })

</script>

<script type="text/x-template" id="app-template">

    <div id="content" class="content">
        <ul class="nav nav-tabs nav-main" role="tablist">
            <li class="active"><a href="#tab1" role="tab" data-toggle="tab">探针列表</a></li>
            <li><a href="#tab2" role="tab" data-toggle="tab">策略管理</a></li>
            <li><a href="#tab3" role="tab" data-toggle="tab">日志配置</a></li>
            <li><a href="#tab4" role="tab" data-toggle="tab">脚本管理</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade in active" id="tab1">
                <div class="row">
                    <div class="col-lg-2">
                        <probe-tree-component id="probe-tree" system="probe"></probe-tree-component>
                    </div>

                    <div class="col-lg-10">
                        <h3 class="page-header"><i class="fas fa-angle-double-right"></i> 探针列表</h3 class="page-header">
                        <probe-card-component :model="probe.summary"></probe-card-component>
                        <probe-list-datatables-component :columns="probe.list.columns"
                                                  :dataset="probe.list.dataset"
                                                  :options="probe.list.options"
                                                  id="probe-list-table"></probe-list-datatables-component>
                        <div class="object-footer">
                            Count: 0 | ${moment().format("LLL")}
                        </div>

                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="tab2">
                <div class="row">
                    <div class="col-lg-2">
                        <probe-tree-component id="policy-tree" system="policy"></-tree-component>
                    </div>

                    <div class="col-lg-10">
                        <h3 class="page-header"><i class="fas fa-angle-double-right"></i> 策略管理</h3 class="page-header">
                        <policy-list-datatables-component :columns="policy.list.columns"
                                                         :dataset="policy.list.dataset"
                                                         :options="policy.list.options"
                                                         id="policy-list-table"></policy-list-datatables-component>
                        <div class="object-footer">
                            Count: 0 | ${moment().format("LLL")}
                        </div>

                    </div>
                </div>
            </div>
            <div class="tab-pane fade in" id="tab3">
                <div class="col-lg-2">
                    <probe-tree-component id="log-tree" system="log"></-tree-component>
                </div>

                <div class="col-lg-10">
                    <h3 class="page-header"><i class="fas fa-angle-double-right"></i> 日志管理</h3 class="page-header">
                    <log-list-datatables-component :columns="log.list.columns"
                                                      :dataset="log.list.dataset"
                                                      :options="log.list.options"
                                                      id="log-list-table"></log-list-datatables-component>
                    <div class="object-footer">
                        Count: 0 | ${moment().format("LLL")}
                    </div>

                </div>
            </div>
            <div class="tab-pane fade in" id="tab4">
                <div class="col-lg-2">
                    <probe-tree-component id="script-tree" system="script"></-tree-component>
                </div>

                <div class="col-lg-10">
                    <h3 class="page-header"><i class="fas fa-angle-double-right"></i> 脚本管理</h3 class="page-header">
                    <script-list-datatables-component :columns="script.list.columns"
                                                      :dataset="script.list.dataset"
                                                      :options="script.list.options"
                                                      id="script-list-table"></script-list-datatables-component>
                    <div class="object-footer">
                        Count: 0 | ${moment().format("LLL")}
                    </div>

                </div>
            </div>
        </div>
    </div>

</script>


{{template "base/footer" .}}
