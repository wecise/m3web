<!--

    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[    CODE BY WANGZD    ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]

-->
{{template "base/head" .}}
<!-- zTree Core CSS -->
<link href="{{AppSubUrl}}/web/vendor/zTree/css/systemStyle/zTreeStyle.css" type="text/css" rel="stylesheet">

<style type="text/css">

    /* For Body */
    body{
        overflow:hidden;
    }

    /* For content */
    #content.content{
        padding: 10px 25px;
    }

    .page-header {
        margin: 0px 0px 5px 0px;
        font-size: 16px;
        color: #888888;
    }

    hr{
        margin-top: 10px;
        margin-bottom: 10px;
    }

    /* For Nav tabs style */
    .nav-tabs {
        background-color: rgb(255, 255, 255) !important;
        background-image: none!important;
        background-repeat: repeat-x;
        border-radius: 0px!important;
    }
    ul.nav-main > li.active {
        border-bottom: 2px solid rgb(3, 169, 244)!important;
    }

</style>

<div id="app"></div>

<!--zTree Core JS-->
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.core-3.5.js"></script>
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.excheck-3.5.js"></script>
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.exedit-3.5.js"></script>

<link rel="vc" href="{{AppSubUrl}}/web/component/ai/ai-robot-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/api/api-list-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/probe/probe-tree-component.html"></link>

<script src="{{AppSubUrl}}/web/css/color/apps.min.js"></script>

<SCRIPT type="text/javascript">

    'use static';

    VueLoader.onloaded(["ai-robot-component",
                        "api-list-component",
                        "probe-tree-component"],function() {


        moment.locale(`{{.Lang}}`);

        $(function () {

            Vue.component("api-view",{
                props: {
                    model: Object
                },
                template: `<div class="row">
                            <div class="col-lg-2">
                                <probe-tree-component id="api-tree" :model="{parent:'/api',name:'api_tree_data.js',domain:'api'}"></probe-tree-component>
                            </div>

                            <div class="col-lg-10 probe-container">
                                <h4 class="page-header"><i class="fas fa-angle-right"></i> 接口列表</h4 class="page-header">
                                <api-list-component :model="model" id="api-list"></api-list-component>-->
                            </div>
                        </div>`
            });

            var appVue = new Vue({
                delimiters: ['${', '}'],
                el: "#app",
                template: "#app-template",
                data: {
                    api: {}
                },
                created:function(){
                    let self = this;

                    eventHub.$on("API-REFRESH-EVENT", self.initData);

                },
                mounted: function () {
                    let self = this;

                    self.$nextTick(function () {
                        
                        self.init();

                    })
                },
                methods: {
                    init: function () {
                        let self = this;

                        //self.initData(['api']);
                    },
                    initPlug: function(){
                        let self = this;

                        /* toggle tab trigger Echart resize */
                        $("a[data-toggle='tab']").on("shown.bs.tab",function(){
                            eventHub.$emit("COMPONENT-REDRAW-EVENT",null);
                        })
                    }
                },
                initData: function(event){
                    let self = this;

                    _.forEach(event,function(v){
                        window[v] = callFsJScript(`/api/api_list.js`,'');

                        if(window[v].status == 'ok'){
                            self[v] = window[v].message;
                        } else {
                            self[v] = [];
                        }
                    })

                }
            })

        });


    })

</script>

<script type="text/x-template" id="app-template">

    <div id="content" class="content">
        <api-view :model="api"></api-view>
    </div>

</script>


{{template "base/footer" .}}
