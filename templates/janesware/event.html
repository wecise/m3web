<!--

    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[    CODE BY WANGZD    ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]

-->
{{template "base/head" .}}
<!--MXClient JS & CSS-->
<script>
	mxBasePath = '{{AppSubUrl}}/web/creative/src';
	mxLanguage = window.MATRIX_LANG.replace(/en/g,"eg").split("-")[0];
</script>

<script src="{{AppSubUrl}}/web/creative/src/js/mxClient.js" type="text/javascript"></script>
<link href="{{AppSubUrl}}/web/creative/graph/styles/grapheditor.css" type="text/css" rel="stylesheet">

<script>
    mxResources.add('{{AppSubUrl}}/web/creative/graph/resources/grapheditor');
</script>
<!-- zTree Core CSS -->
<link href="{{AppSubUrl}}/web/vendor/zTree/css/systemStyle/zTreeStyle.css" type="text/css" rel="stylesheet">


<style>

	/* body */
	body {
		overflow:hidden;
	}

	/* content */
	#content.content {
		padding: 5px 10px 0px 5px;
	}

	/* Event view */
	.tree-view {
		padding: 0 15px;
	}

	/* 运维模式 */
	.view-normal .tree-view {
		display: none;
		width: 0%;
	}
	.view-normal .table-view {
		width: 100%;
	}

	/* 标签树模式 */
	.view-tags .tree-view {
		width: 18%;
	}
	.view-tags .table-view {
		width: 82%;
	}

	/* 全屏模式 */
	.view-fullscreen .tree-view {
		display: none;
		width: 0%;
	}
	.view-fullscreen .table-view {
		width: 100%;
	}

	/* timeline view */
	.timeline-view {
		background: rgb(250, 250, 250);
	}

	/* table view */
	.table-view {
		padding-top: 10px!important;
	}


	/* nav nav-tabs nav-tabs-line-2px li a */
	.panel-title-btn .nav-tabs-line-2px{
		margin: 0 -15px;
	}
	.panel-title-btn .nav-tabs-line-2px > li > a {
		padding: 0px 15px
	}

	/* 自定义Panel */
	.panel.panel-default.panel-white-border {
		margin-bottom: 10px;
		border: 1px solid rgb(250, 250, 250);
	}

	.panel-white-border .panel-heading .nav-tabs {
		margin-left: -13px;
		margin-top: -8px;
		margin-right: -15px;
	}

	.panel-white-border .panel-title{
		height: 18px;
	}
	.panel-white-border .panel-body {
		padding:0 10px;
	}

	/* grid */
	.masonry-column {
		padding: 0 1px;
	}

	.masonry-grid > div .panel-white-border {
		margin: 5px 1px;
	}

	/* 告警详情页Tab */
	.nav-tabs.event-detail-data-ul > li {
		position:relative;
	}
	.nav-tabs.event-detail-data-ul > li > a {
		display:inline-block;
	}
	.nav-tabs.event-detail-data-ul > li > span {
		display:none;
		cursor:pointer;
		position:absolute;
		right: 6px;
		top: 8px;
		color: red;
	}
	.nav-tabs.event-detail-data-ul > li:hover > span {
		display: inline-block;
	}

	.nav-tabs.event-detail-data-ul > li > span {
	    display:none;
	    cursor:pointer;
	    position:absolute;
	    right: 3px;
	    top: 8px;
	    color: #999;
	}

	/* layout */
	/* clearfix */
	.grid:after {
		content: '';
		display: block;
		clear: both;
	}

	/* ---- grid-item ---- */

	.grid-sizer,
	.grid-item {
		width: 100%;
	}

	.grid-item {
		height: auto;
		float: left;
		border-radius: 5px;
		margin:2px;
	}

</style>

<div id="app"></div>

<script src="{{AppSubUrl}}/web/js/model/Event.js"></script>

<!--zTree Core JS-->
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.core-3.5.js"></script>
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.excheck-3.5.js"></script>
<script src="{{AppSubUrl}}/web/vendor/zTree/js/jquery.ztree.exedit-3.5.js"></script>

<!-- ECharts单文件引入 --> 
<script src="{{AppSubUrl}}/web/vendor/echart/echarts.min.js"></script>

<link rel="vc" href="{{AppSubUrl}}/web/component/ai/ai-robot-component.vue"></link>

<link rel="vc" href="{{AppSubUrl}}/web/component/event/event-datatable-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/event/event-diagnosis-datatable-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/event/event-graph-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/event/event-summary-component.html"></link>

<link rel="vc" href="{{AppSubUrl}}/web/component/search/search-base-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/search/search-preset-component_{{.Lang}}.html"></link>

<link rel="vc" href="{{AppSubUrl}}/web/component/probe/probe-tree-component.html"></link>


<script type="text/x-template" id="app-template">
	<div id="content" class="content">
		<div class="grid" data-masonry="{itemSelector: '.grid-item',columnWidth: '.grid-item',percentPosition: true}">
			<div class="grid-item">
				<search-base-component :id="model.id"
				                       :options="options"
				                       ref="searchRef"></search-base-component>
			</div>
			<div class="grid-item">
				<tabs v-model="layout.main.index">
					<tab :title="item.title" v-for="(item,index) in layout.main.tabs"  html-title>
						<div v-if="item.type==='main'">
							<div class="panel panel-default panel-white-border" data-sortable-id="ui-modal-notification-1">
								<div class="panel-heading">
									<div class="panel-heading-btn">
										<a href="javascript:;" class="btn btn-xs btn-icon" data-click="panel-expand"><i class="fa fa-expand"></i></a>
										<a href="javascript:;" class="btn btn-xs btn-icon" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
									</div>
									<h4 class="panel-title"></h4>
								</div>
								<div class="panel-body" style="height:calc(100vh - 185px);">
									<div class="row" style="height:200px;">
										<div class="col-md-12">
											<tabs v-model="layout.summary.index">
												<tab :title="item.title" v-for="item in layout.summary.tabs">
													<div v-if="item.type=='radar'">
															<event-view-radar id="event-radar"></event-view-radar>
														</div>
													<div v-if="item.type=='timeline'">
														<event-view-timeline id="event-timeline"></event-view-timeline>
													</div>
												</tab>
											</tabs>
										</div>
									</div>
									<div class="row"  style="height:calc(100vh - 245px);">
										<div class="col-md-2 tree-view animated fadeInRight">
											<probe-tree-component id="event-tree" :model="{parent:'/event',name:'event_tree_data.js',domain:'event'}"></probe-tree-component>
										</div>
										<div class="col-md-10 table-view animated fadeInLeft">
											<event-datatable-component id="event-list" :model="model.message"></event-datatable-component>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div v-if="item.type==='detail'">
							<tabs v-model="layout.main.detail.index">
								<template slot="nav-right">
									<a href="javascript:void(0);" class="btn btn-xs btn-default" style="cursor:pointer;" @click="close(index)">
										<span class="fas fa-times"></span>
									</a>
								</template>
								<tab :title="it | pickTitle(layout.main.detail.model[index - 1],index)" v-for="it in item.child" :key="it.id" html-title>
									<div v-if="it.type==='event'">
										<event-view-detail :id="it.id" :model="layout.main.detail.model[index - 1][it.type]"></event-view-detail>
									</div>
									<div v-else>
										<event-diagnosis-datatable-component :id="it.id" :model="layout.main.detail.model[index - 1][it.type]"></event-diagnosis-datatable-component>
									</div>
								</tab>
							</tabs>
						</div>
					</tab>
				</tabs>
			</div>
		</div>
	</div>
</script>

<script type="text/x-template" id="event-view-timeline-template">
	<div>${id}</div>
</script>

<script type="text/x-template" id="event-view-radar-template">
	<event-summary-component id="event-radar"></event-summary-component>
</script>

{{template "base/footer" .}}
