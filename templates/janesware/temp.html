<!--

    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[    CODE BY WANGZD    ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [:::::[                      ]:::::]
    [::::::[[[[[[[:      :]]]]]]]::::::]
    [::::::::::::::      ::::::::::::::]
    [::::::::::::::      ::::::::::::::]
    [[[[[[[[[[[[[[[      ]]]]]]]]]]]]]]]

-->
{{template "base/head" .}}

<!-- zTree Core CSS -->
<link href="{{AppSubUrl}}/web/vendor/zTree/css/mxobjectTreeStyle/zTreeStyle.css" type="text/css" rel="stylesheet">

<style type="text/css">


	body {
		overflow: hidden;
	}

	.lm_goldenlayout {
		background: none;
		background-color: rgb(249, 249, 249);
	}

	.lm_content {
		background: rgb(255, 255, 255);
		border: 1px solid rgb(255, 255, 255);
		overflow: auto;
	}

	.lm_header .lm_tab.lm_active {
		border-bottom: none;
		box-shadow: none;
		padding-bottom: 5px;
	}

	.lm_tab:hover, .lm_tab.lm_active {
		background: rgb(255, 255, 255);
		color: rgb(119, 119, 119);
	}

	.lm_header .lm_tab {
		border: none;
	}

	[id="app"] {
		width: 100vw;
		height: 100vh;
	}



</style>


<link rel="vc" href="{{AppSubUrl}}/web/component/vue-base-datatables-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-object-tree-component.html"></link>
<link rel="vc" href="{{AppSubUrl}}/web/component/vue-editor-component.html"></link>


<!-- Golden Layout container -->
<div id="app"></div>

<script>

    $(".current-active-item").html(`<a class="active item" href="/janesware/object">
										<i class="fa fa-cube"></i>  {{.i18n.Tr .ActiveView }}
									</a>`);

    VueLoader.onloaded(["vue-base-datatables-component",
	                    "vue-object-tree-component",
	                    "vue-editor-component"], function() {

        let classTree = {
            delimiters: ['${', '}'],
            el: '#class-tree-template',
            data: {

            },
            mounted: function() {
                let self = this;

                self.$nextTick(function() {

                })
            },
            methods: {

            }
        };

        let queryConsole = {
            delimiters: ['${', '}'],
            el: '#query-console-template',
            data: {
                model:{
                    oldInput: "",
                    newInput: "",
                    mode: "toml",
                    theme: "tomorrow",
                    printMargin: false,
                    readOnly: false
                }
            },
            mounted: function() {
                let self = this;

                self.$nextTick(function() {

                })
            },
            methods: {

            }
        };

        let queryOutput = {
            delimiters: ['${', '}'],
            el: '#query-output-template',
            data: {

            },
            mounted: function() {
                let self = this;

                self.$nextTick(function() {

                })
            },
            methods: {

            }
        };

        let VueApp = new Vue({
	        delimiters: ['${', '}'],
	        el: '#app',
	        data: {
	            config: {
                    settings:{
                        showPopoutIcon: false,
                        showCloseIcon: false
                    },
                    content: [{
                        type: 'row',
                        content:[
                            {
                                type: 'stack',
                                width: 20,
                                content:[{
                                    type: 'component',
                                    componentName: 'omdbComponent',
                                    title:'对象管理',
                                    isClosable: false,
                                    componentState: {
                                        id: 'class-tree',
                                        templateId: 'class-tree-template'
                                    }
                                }]
                            },
                            {
                                type: 'column',
                                content:[{
                                    type: 'component',
                                    componentName: 'omdbComponent',
                                    title:'查询',
                                    componentState: {
                                        id: 'query-console',
                                        templateId: 'query-console-template'
                                    }
                                },{
                                    type: 'stack',
                                    content:[{
                                        type: 'component',
                                        componentName: 'omdbComponent',
                                        title:'列表',
                                        componentState: {
                                            id: 'query-output-grid',
                                            templateId: 'query-output-grid-template'
                                        }
                                    },
                                    {
                                        type: 'component',
                                        componentName: 'omdbComponent',
                                        title:'文本',
                                        componentState: {
                                            id: 'query-output-text',
                                            templateId: 'query-output-text-template'
                                        }
                                    }]
                                }]
                            }
                        ]
                    }]
                }

	        },
            mounted: function() {
				let self = this;

                self.$nextTick(function() {
                    setTimeout(function () {
                        self.init();
                    });
                })
		    },
	        methods: {
	            init: function(){
	                let self = this;

                    //var savedState = localStorage.getItem('savedState');
                    //self.config = savedState !== null ? JSON.parse(savedState) : self.config;

                    var layout = new GoldenLayout(self.config, self.$el);

                    layout.registerComponent('omdbComponent', function (container, state) {
                        var html = "<div id=\"" + state.templateId + "\">" + $('#' + state.templateId).html() + "</div>";
                        container.getElement().html(html);

                        setTimeout(function(){
                            if(state.id == 'class-tree'){
                                new Vue(classTree);
                            } else if(state.id == 'query-console'){
                                new Vue(queryConsole);
                            } else if(state.id == 'query-output'){
                                new Vue(queryOutput);
                            }
                        })
                    });
                    //
                    //	Save state in local storage
                    //
                    layout.on('stateChanged', function () {
                        var state = JSON.stringify(layout.toConfig());
                        localStorage.setItem('savedState', state);
                    });
                    //  Initialize GL
                    layout.init();
                    //  Update GL on window resize
                    window.addEventListener('resize', function () { layout.updateSize(); });

	            },
	            resetLayout: function () {
	                localStorage.removeItem('savedState');
	                window.location.reload(true);
	            },
		        initClassTree: function(){
	                let self = this;
		        },
                queryConsole: function(){
                    let self = this;

                    return {
                        methods: {
							init: function(){
							    alert(3)
							}
                        }
                    }
                },
                initQueryOutput: function(){
                    let self = this;
                }
	        }
	    });



    })
</script>


<script type="text/x-template"  id="class-tree-template">
	<vue-object-tree-component id="omdb-class-tree"></vue-object-tree-component>
</script>

<script type="text/x-template"  id="query-console-template">
	<vue-editor-component id="query-console" :model="model"></vue-editor-component>
</script>

<script type="text/x-template"  id="query-output-grid-template">

</script>

<script type="text/x-template"  id="query-output-text-template">

</script>


{{template "base/footer" .}}

